<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>HazeNote Urban</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Urbanist:ital,wght@0,100..900;1,100..900&display=swap" rel="stylesheet">
    
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        black: '#000000',     // æè‡´é»‘
                        dark: '#111111',      // å¡ç‰‡é»‘
                        light: '#F6F6F6',     // äº®è‰²å¡ç‰‡èƒŒæ™¯
                        teal: '#85B9C9',      // æ ¸å¿ƒè‰²ï¼šè¿·é›¾é’
                        peach: '#FFBE9D',     // æ ¸å¿ƒè‰²ï¼šæŸ”å’Œæ¡ƒ (è§†è§‰æå–)
                        purple: '#A29BFE',    // æ ¸å¿ƒè‰²ï¼šé™è°§ç´« (è§†è§‰æå–)
                        orange: '#FF6B4A',    // å¼ºè°ƒè‰²ï¼šæ·±æ©™ (ç”¨äºYear End Partyå¡ç‰‡)
                    },
                    fontFamily: {
                        sans: ['Urbanist', 'sans-serif'], // å…¨å±€åº”ç”¨ Urbanist
                    },
                    borderRadius: {
                        '4xl': '2rem',
                    }
                }
            }
        }
    </script>

    <style>
        * { -webkit-font-smoothing: antialiased; -moz-osx-font-smoothing: grayscale; }
        body { 
            background-color: #000000; 
            color: white; 
            font-family: 'Urbanist', sans-serif;
            overscroll-behavior: none; 
        }
        
        .no-scrollbar::-webkit-scrollbar { display: none; }
        .no-scrollbar { -ms-overflow-style: none; scrollbar-width: none; }
        
        /* === æœ‰æœºæ³¢æµªä¸å½¢çŠ¶ === */
        /* æ¨¡æ‹Ÿæˆªå›¾ä¸­çš„æ‹¼å›¾æ³¢æµªæ•ˆæœ */
        .wave-divider {
            position: absolute;
            width: 40px;
            height: 100%;
            background: radial-gradient(circle at 0 50%, transparent 25px, #FF6B4A 26px);
            left: -40px;
            top: 0;
            z-index: 10;
        }

        .blob-bg {
            position: absolute;
            border-radius: 50%;
            filter: blur(60px);
            z-index: 0;
            opacity: 0.5;
        }

        /* æŠ½è±¡è£…é¥°å›¾å½¢ - è¿˜åŸæˆªå›¾ä¸­çš„ Task Today èƒŒæ™¯ */
        .abstract-shape-1 {
            position: absolute;
            top: -20px; right: -20px;
            width: 140px; height: 140px;
            background: #FFBE9D;
            border-radius: 40% 60% 70% 30% / 40% 50% 60% 50%;
        }
        .abstract-shape-2 {
            position: absolute;
            top: 40px; right: -40px;
            width: 120px; height: 120px;
            background: #A29BFE;
            border-radius: 60% 40% 30% 70% / 60% 30% 70% 40%;
        }
        
        /* ç»†çº¿è£…é¥° */
        .thin-line-circle {
            position: absolute;
            border: 1px solid rgba(255,255,255,0.2);
            border-radius: 50%;
            width: 200px; height: 200px;
            right: -80px; top: 20px;
            transform: rotate(-15deg);
        }

        /* ç™»å½•é¡µå¤§å­— */
        .login-title {
            font-size: 4rem;
            line-height: 1;
            font-weight: 800; /* ExtraBold */
            letter-spacing: -0.02em;
        }

        /* ç»ç’ƒæ€ */
        .glass {
            background: rgba(17, 17, 17, 0.8);
            backdrop-filter: blur(20px);
            -webkit-backdrop-filter: blur(20px);
            border: 1px solid rgba(255,255,255,0.05);
        }

        /* è¾“å…¥æ¡†å»æ ·å¼ */
        textarea:focus { outline: none; }
        
        /* åŠ¨ç”» */
        .fade-in { animation: fadeIn 0.5s ease-out forwards; opacity: 0; }
        @keyframes fadeIn { from { opacity: 0; transform: translateY(10px); } to { opacity: 1; transform: translateY(0); } }
    </style>
</head>
<body class="flex justify-center min-h-screen overflow-hidden bg-black selection:bg-teal selection:text-black">

    <div class="blob-bg w-64 h-64 bg-teal/20 top-0 left-0"></div>
    <div class="blob-bg w-80 h-80 bg-purple/20 bottom-0 right-0"></div>

    <div id="loginScreen" class="w-full max-w-md h-full flex flex-col items-center justify-center px-8 relative z-50 bg-black">
        <div class="text-left w-full mb-12">
            <h1 class="login-title text-white mb-2">Haze<br/><span class="text-teal">Note.</span></h1>
            <p class="text-gray-400 text-lg font-medium">Thoughts, clearer.</p>
        </div>
        
        <button id="passkeyBtn" onclick="handlePasskey()" class="w-full py-5 rounded-full bg-white text-black font-bold text-xl hover:bg-gray-200 transition-colors flex items-center justify-center gap-3">
            <i class="fa-solid fa-face-smile text-2xl"></i>
            <span id="passkeyBtnText">Unlock</span>
        </button>
        <p class="mt-6 text-gray-600 text-sm">Secured by WebAuthn</p>
    </div>

    <div id="mainApp" class="w-full max-w-md h-screen flex flex-col hidden relative z-10 bg-black">
        
        <header class="px-6 pt-14 pb-6 flex justify-between items-end z-20">
            <div>
                <div class="flex items-center gap-2 mb-4">
                    <div class="w-8 h-8 rounded-full bg-gradient-to-tr from-teal to-purple p-[1px]">
                        <img src="https://api.dicebear.com/7.x/notionists/svg?seed=Felix" class="w-full h-full rounded-full bg-black" alt="Avatar">
                    </div>
                    <span class="text-sm font-semibold text-gray-400">Hi, Designer</span>
                </div>
                <h1 class="text-5xl font-bold text-white leading-[0.9]">My<br/>Notes</h1>
            </div>
            
            <div class="bg-[#1A1A1A] rounded-full p-1 pl-5 pr-1 flex items-center gap-3 h-14 border border-white/5">
                <i class="fa-solid fa-magnifying-glass text-white text-lg"></i>
                <div class="bg-black text-white border border-white/10 font-bold rounded-full w-12 h-12 flex items-center justify-center text-lg" id="noteCountBadge">0</div>
            </div>
        </header>

        <main id="noteList" class="flex-1 overflow-y-auto px-5 pb-32 space-y-4 no-scrollbar">
            </main>

        <div class="fixed bottom-8 left-0 right-0 flex justify-center z-50 pointer-events-none">
            <div class="pointer-events-auto bg-[#111111] border border-white/10 shadow-2xl rounded-[32px] px-6 py-4 flex items-center justify-between w-[85%] max-w-[340px]">
                <button onclick="triggerImport()" class="text-gray-500 hover:text-white transition">
                    <i class="fa-solid fa-file-arrow-up text-xl"></i>
                </button>
                
                <button onclick="exportData()" class="text-gray-500 hover:text-white transition">
                    <i class="fa-solid fa-file-arrow-down text-xl"></i>
                </button>

                 <button onclick="lockApp()" class="text-gray-500 hover:text-white transition">
                    <i class="fa-solid fa-lock text-xl"></i>
                </button>

                <button onclick="openNewNoteModal()" class="w-12 h-12 rounded-2xl bg-teal text-black flex items-center justify-center hover:scale-105 transition shadow-lg shadow-teal/20">
                    <i class="fa-solid fa-plus text-xl"></i>
                </button>
            </div>
        </div>
    </div>

    <div id="noteModal" class="fixed inset-0 bg-black z-[60] hidden flex flex-col">
        <div class="px-6 pt-14 pb-4 flex justify-between items-center">
            <button onclick="closeModal()" class="w-12 h-12 rounded-full border border-white/10 flex items-center justify-center text-white hover:bg-white/10 transition">
                <i class="fa-solid fa-arrow-left text-lg"></i>
            </button>
            <span id="modalDate" class="font-bold text-gray-500 tracking-wide text-sm uppercase">Date</span>
            <button onclick="saveNote()" class="w-12 h-12 rounded-full bg-teal text-black flex items-center justify-center font-bold text-sm hover:scale-105 transition">
                OK
            </button>
        </div>

        <div class="flex-1 px-8 pt-4">
            <textarea id="noteInput" class="w-full h-full bg-transparent text-white text-3xl font-semibold placeholder-gray-700 resize-none leading-normal" placeholder="Type something..."></textarea>
        </div>

        <div class="px-8 pb-10">
            <div class="flex gap-4 overflow-x-auto py-2">
                <button onclick="selectColor('dark')" class="w-10 h-10 rounded-full bg-[#111111] border border-white/20 ring-2 ring-white ring-offset-2 ring-offset-black color-btn"></button>
                <button onclick="selectColor('teal')" class="w-10 h-10 rounded-full bg-teal color-btn"></button>
                <button onclick="selectColor('orange')" class="w-10 h-10 rounded-full bg-orange color-btn"></button>
                <button onclick="selectColor('light')" class="w-10 h-10 rounded-full bg-white color-btn"></button>
            </div>
        </div>
    </div>

    <input type="file" id="fileInput" class="hidden" accept=".json" onchange="importData(this)">

    <script>
    // ========== æ ¸å¿ƒé€»è¾‘ ==========
    
    // Passkey & Crypto (ä¿ç•™åŸåŠŸèƒ½)
    const PasskeyModule={CREDENTIAL_KEY:'hazenote_passkey_credential',ENCRYPTION_KEY_STORAGE:'hazenote_passkey_encryption_key',isSupported(){return window.PublicKeyCredential!==undefined},hasCredential(){return localStorage.getItem(this.CREDENTIAL_KEY)!==null},bufferToBase64URL(buffer){const bytes=new Uint8Array(buffer);let str='';for(const byte of bytes)str+=String.fromCharCode(byte);return btoa(str).replace(/\+/g,'-').replace(/\//g,'_').replace(/=/g,'')},base64URLToBuffer(base64url){const base64=base64url.replace(/-/g,'+').replace(/_/g,'/');const padded=base64+'='.repeat((4-base64.length%4)%4);const binary=atob(padded);const bytes=new Uint8Array(binary.length);for(let i=0;i<binary.length;i++)bytes[i]=binary.charCodeAt(i);return bytes.buffer},async register(){const userId=crypto.getRandomValues(new Uint8Array(16));const challenge=crypto.getRandomValues(new Uint8Array(32));const encryptionKey=this.bufferToBase64URL(crypto.getRandomValues(new Uint8Array(32)));const options={challenge,rp:{name:'HazeNote',id:location.hostname||'localhost'},user:{id:userId,name:'HazeNote User',displayName:'HazeNote User'},pubKeyCredParams:[{alg:-7,type:'public-key'},{alg:-257,type:'public-key'}],authenticatorSelection:{authenticatorAttachment:'platform',userVerification:'required',residentKey:'preferred'},timeout:60000,attestation:'none'};const credential=await navigator.credentials.create({publicKey:options});localStorage.setItem(this.CREDENTIAL_KEY,JSON.stringify({id:credential.id,rawId:this.bufferToBase64URL(credential.rawId)}));localStorage.setItem(this.ENCRYPTION_KEY_STORAGE,encryptionKey);return encryptionKey},async authenticate(){const stored=JSON.parse(localStorage.getItem(this.CREDENTIAL_KEY));if(!stored)throw new Error('NO_CREDENTIAL');const options={challenge:crypto.getRandomValues(new Uint8Array(32)),rpId:location.hostname||'localhost',allowCredentials:[{id:this.base64URLToBuffer(stored.rawId),type:'public-key',transports:['internal']}],userVerification:'required',timeout:60000};await navigator.credentials.get({publicKey:options});return localStorage.getItem(this.ENCRYPTION_KEY_STORAGE)}};
    const CryptoModule={async importKey(keyString){const keyData=new TextEncoder().encode(keyString.padEnd(32,'0').substring(0,32));return crypto.subtle.importKey('raw',keyData,{name:'AES-GCM'},false,['encrypt','decrypt'])},async encrypt(data,keyString){const key=await this.importKey(keyString);const iv=crypto.getRandomValues(new Uint8Array(12));const encrypted=await crypto.subtle.encrypt({name:'AES-GCM',iv},key,new TextEncoder().encode(JSON.stringify(data)));const result=new Uint8Array(iv.length+encrypted.byteLength);result.set(iv,0);result.set(new Uint8Array(encrypted),iv.length);return btoa(String.fromCharCode(...result))},async decrypt(encryptedBase64,keyString){try{const key=await this.importKey(keyString);const data=Uint8Array.from(atob(encryptedBase64),c=>c.charCodeAt(0));const decrypted=await crypto.subtle.decrypt({name:'AES-GCM',iv:data.slice(0,12)},key,data.slice(12));return JSON.parse(new TextDecoder().decode(decrypted))}catch{return null}}};
    const DataModule={NOTES_KEY:'hazenote_encrypted_data',async save(notes,key){localStorage.setItem(this.NOTES_KEY,await CryptoModule.encrypt(notes,key))},async load(key){const d=localStorage.getItem(this.NOTES_KEY);return d?await CryptoModule.decrypt(d,key)||[]:[]}};
    const Session={KEY:'hazenote_session',get(){const s=sessionStorage.getItem(this.KEY);return s?JSON.parse(s):null},set(key){sessionStorage.setItem(this.KEY,JSON.stringify({encryptionKey:key}))},clear(){sessionStorage.removeItem(this.KEY)}};

    let notes = [];
    let selectedColor = 'dark';

    window.onload = async () => {
        if (!PasskeyModule.isSupported()) document.getElementById('passkeyBtn').style.display = 'none';
        updateLoginBtn();
        const s = Session.get(); 
        if (s) await initApp(s.encryptionKey);
    };

    function updateLoginBtn() {
        const has = PasskeyModule.hasCredential();
        document.getElementById('passkeyBtnText').textContent = has ? 'Unlock' : 'Create Passkey';
    }

    async function handlePasskey() {
        try {
            const key = PasskeyModule.hasCredential() ? await PasskeyModule.authenticate() : await PasskeyModule.register();
            Session.set(key); await initApp(key);
        } catch (e) { alert('Authentication failed or cancelled.'); }
    }

    async function initApp(key) {
        document.getElementById('loginScreen').classList.add('hidden');
        document.getElementById('mainApp').classList.remove('hidden');
        notes = await DataModule.load(key);
        renderNotes();
    }

    function lockApp() { Session.clear(); notes = []; document.getElementById('mainApp').classList.add('hidden'); document.getElementById('loginScreen').classList.remove('hidden'); }

    // ========== æ¸²æŸ“é€»è¾‘ (Bento Grid) ==========
    function renderNotes() {
        const list = document.getElementById('noteList');
        list.innerHTML = '';
        document.getElementById('noteCountBadge').textContent = notes.length;

        if (notes.length === 0) {
            list.innerHTML = `<div class="mt-20 flex flex-col items-center opacity-30"><div class="text-6xl mb-4">ğŸŒ‘</div><p>Space is empty.</p></div>`;
            return;
        }

        notes.sort((a, b) => new Date(b.date) - new Date(a.date));

        // å°†ç¬”è®°ä¸¤ä¸¤åˆ†ç»„ï¼Œä»¥å®ç° Bento Grid å¸ƒå±€
        // ç¬¬1ä¸ª: å¤§å¡ç‰‡ (Task Today é£æ ¼)
        // ç¬¬2ä¸ª: å°å¡ç‰‡ (UI Trend é£æ ¼)
        // ç¬¬3ä¸ª: ç°è‰²å¡ç‰‡ (æ‹¼å›¾å·¦)
        // ç¬¬4ä¸ª: æ©™è‰²å¡ç‰‡ (æ‹¼å›¾å³)
        
        let gridHTML = '';
        
        // æ¸²æŸ“ç¬¬ä¸€è¡Œ (1å¤§ + 1å°)
        if (notes[0]) gridHTML += createCardHTML(notes[0], 'large-dark');
        
        // å‰©ä½™çš„
        if (notes.length > 1) {
            for (let i = 1; i < notes.length; i++) {
                const note = notes[i];
                // æ¨¡æ‹Ÿæˆªå›¾ä¸­çš„æ‹¼å›¾å¸ƒå±€: å¦‚æœæ˜¯å¶æ•°ç´¢å¼•(åœ¨å‰©ä½™åˆ—è¡¨ä¸­), å°è¯•å’Œä¸‹ä¸€ä¸ªç»„æˆæ‹¼å›¾
                // è¿™é‡Œç®€åŒ–é€»è¾‘ï¼šæ ¹æ®é¢œè‰²æˆ–éšæœºåˆ†é…æ ·å¼
                let style = 'simple';
                if (note.color === 'orange') style = 'orange-wave';
                else if (note.color === 'light') style = 'light-simple';
                else if (note.color === 'teal') style = 'teal-block';
                else style = 'dark-simple';
                
                gridHTML += createCardHTML(note, style);
            }
        }
        
        list.innerHTML = gridHTML;
    }

    function createCardHTML(note, type) {
        const dateObj = new Date(note.date);
        const dateStr = `${dateObj.getDate()} ${dateObj.toLocaleString('en', { month: 'short' })}`;
        
        // 1. é¡¶éƒ¨å¤§å¡ç‰‡ (Task Today é£æ ¼) - é»‘åº• + è£…é¥°å›¾å½¢
        if (type === 'large-dark') {
            return `
            <div onclick="copyText('${note.content}')" class="fade-in relative w-full bg-[#111111] rounded-[32px] p-6 mb-4 overflow-hidden min-h-[220px] border border-white/5 flex flex-col justify-between group">
                <div class="abstract-shape-1"></div>
                <div class="abstract-shape-2"></div>
                <div class="thin-line-circle"></div>
                
                <div class="relative z-10 mt-8">
                    <h2 class="text-4xl font-bold leading-tight mb-2 tracking-tight">Note<br/>Today</h2>
                </div>
                <div class="relative z-10 bg-[#FFE8D6] text-black p-4 rounded-2xl transform group-active:scale-95 transition-transform">
                    <p class="text-sm font-medium line-clamp-3 leading-relaxed">${note.content}</p>
                </div>
                <button onclick="event.stopPropagation(); deleteNote('${note.id}')" class="absolute top-4 right-4 text-white/20 hover:text-white z-20"><i class="fa-solid fa-xmark text-xl"></i></button>
            </div>`;
        }
        
        // 2. æ©™è‰²å¡ç‰‡ (Year End Party é£æ ¼) - å·¨å¤§çš„å­—ä½“
        if (type === 'orange-wave') {
            return `
            <div onclick="copyText('${note.content}')" class="fade-in w-full bg-[#FF6B4A] text-black rounded-[32px] p-6 mb-4 min-h-[180px] flex items-center justify-center text-center relative overflow-hidden group">
                 <div class="absolute left-[-20px] top-[50%] transform -translate-y-1/2 w-10 h-10 bg-black rounded-full"></div>
                 
                 <p class="text-5xl font-black leading-none uppercase break-words w-full" style="word-spacing: 9999px;">${note.content.substring(0,12)}</p>
                 <span class="absolute bottom-4 right-6 text-xs font-bold opacity-60">${dateStr}</span>
                 <button onclick="event.stopPropagation(); deleteNote('${note.id}')" class="absolute top-4 right-4 opacity-30 hover:opacity-100"><i class="fa-solid fa-trash"></i></button>
            </div>`;
        }

        // 3. äº®è‰²å¡ç‰‡ (UI Trend é£æ ¼) - ç™½åº•é»‘å­—
        if (type === 'light-simple') {
            return `
            <div onclick="copyText('${note.content}')" class="fade-in w-full bg-[#F6F6F6] text-black rounded-[32px] p-6 mb-4 border border-white/10 relative group">
                <div class="flex justify-between items-start mb-4">
                    <div class="w-2 h-8 bg-black rounded-full"></div>
                    <img src="https://api.dicebear.com/7.x/shapes/svg?seed=${note.id}" class="w-8 h-8 opacity-20">
                </div>
                <h3 class="text-2xl font-bold mb-1">Memo</h3>
                <p class="text-gray-600 font-medium leading-snug line-clamp-3">${note.content}</p>
                 <button onclick="event.stopPropagation(); deleteNote('${note.id}')" class="absolute top-6 right-6 text-gray-300 hover:text-red-500"><i class="fa-solid fa-trash"></i></button>
            </div>`;
        }
        
        // 4. é’è‰²å¡ç‰‡ (Urbanist é£æ ¼)
        if (type === 'teal-block') {
            return `
            <div onclick="copyText('${note.content}')" class="fade-in w-full bg-teal text-black rounded-[32px] p-6 mb-4 relative group">
                <p class="text-xl font-bold leading-tight line-clamp-4">${note.content}</p>
                <div class="mt-4 flex justify-between items-center border-t border-black/10 pt-2">
                    <span class="text-xs font-bold opacity-50">${dateStr}</span>
                    <button onclick="event.stopPropagation(); deleteNote('${note.id}')" class="opacity-40 hover:opacity-100"><i class="fa-solid fa-trash"></i></button>
                </div>
            </div>`;
        }

        // é»˜è®¤æ·±è‰²å¡ç‰‡ (Simple Dark)
        return `
        <div onclick="copyText('${note.content}')" class="fade-in w-full bg-[#1A1A1A] rounded-[32px] p-6 mb-4 border border-white/5 relative group">
            <p class="text-lg text-gray-200 font-medium line-clamp-3 mb-6">${note.content}</p>
            <span class="text-4xl font-bold text-gray-700 absolute bottom-[-10px] right-4 opacity-20">${dateStr.split(' ')[0]}</span>
            <div class="absolute bottom-6 left-6 text-xs text-gray-500 font-bold uppercase tracking-widest">${dateStr}</div>
            <button onclick="event.stopPropagation(); deleteNote('${note.id}')" class="absolute top-6 right-6 text-gray-600 hover:text-white"><i class="fa-solid fa-trash"></i></button>
        </div>`;
    }

    // CRUD
    function selectColor(color) {
        selectedColor = color;
        // Visual feedback
        document.querySelectorAll('.color-btn').forEach(b => b.classList.remove('ring-2', 'ring-white'));
        event.target.classList.add('ring-2', 'ring-white');
    }

    function openNewNoteModal() {
        document.getElementById('noteInput').value = '';
        selectColor('dark');
        document.getElementById('noteModal').classList.remove('hidden');
        document.getElementById('noteInput').focus();
        document.getElementById('modalDate').innerText = new Date().toLocaleDateString('en', {weekday:'short', day:'numeric'}).toUpperCase();
    }

    function closeModal() { document.getElementById('noteModal').classList.add('hidden'); }

    async function saveNote() {
        const c = document.getElementById('noteInput').value.trim();
        if(!c) return closeModal();
        notes.unshift({ id: Date.now().toString(), content: c, date: new Date().toISOString(), color: selectedColor });
        await DataModule.save(notes, Session.get().encryptionKey);
        renderNotes(); closeModal();
    }

    async function deleteNote(id) {
        if(confirm('Delete note?')) {
            notes = notes.filter(n => n.id !== id);
            await DataModule.save(notes, Session.get().encryptionKey);
            renderNotes();
        }
    }
    
    function copyText(txt) {
        navigator.clipboard.writeText(txt);
        // Simple feedback
        const badge = document.getElementById('noteCountBadge');
        const orig = badge.innerText;
        badge.innerText = 'âœ“';
        setTimeout(() => badge.innerText = orig, 1000);
    }

    // Import/Export
    async function exportData() {
        const d = { app: 'HazeNote', version: '3.1', notes };
        const a = document.createElement('a');
        a.href = 'data:text/json;charset=utf-8,'+encodeURIComponent(JSON.stringify(d));
        a.download = `HazeNote_${Date.now()}.json`; a.click();
    }
    function triggerImport(){ document.getElementById('fileInput').click(); }
    async function importData(input){
        const f = input.files[0]; if(!f)return;
        const r = new FileReader();
        r.onload=async e=>{
            try{
                const d=JSON.parse(e.target.result);
                if(d.app==='HazeNote'){
                    notes=[...d.notes,...notes];
                    // dedup based on id
                    notes = Array.from(new Map(notes.map(item => [item['id'], item])).values());
                    await DataModule.save(notes, Session.get().encryptionKey);
                    renderNotes(); alert('Imported.');
                }
            }catch{alert('Error');}
        }; r.readAsText(f);
    }
    </script>
</body>
</html>
